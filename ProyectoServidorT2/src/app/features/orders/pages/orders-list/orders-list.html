<div class="orders-container">
  <div class="orders-header">
    <h1>Mis Pedidos</h1>
  </div>

  <div class="filters-section">
    <app-order-filters
      [filters]="filters"
      (filtersChange)="onFiltersChange($event)">
    </app-order-filters>
  </div>

  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Cargando pedidos...</p>
  </div>

  <div *ngIf="!loading && orders.length === 0" class="empty-state">
    <p>Aún no has realizado ningún pedido.</p>
    <a routerLink="/productos" class="btn-shop">Ir a la tienda</a>
  </div>

  <div class="orders-list" *ngIf="!loading && orders.length > 0">
    <div class="order-card" *ngFor="let order of orders; trackBy: trackById" (click)="viewOrder(order)">
      <div class="card-header">
        <span class="order-id">#{{ order.id }}</span>
        <span class="order-date">{{ order.created_at | date:'d MMM y' }}</span>
      </div>
      
      <div class="card-body">
        <div class="info-row">
            <span class="label">Total:</span> 
            <span class="value total">{{ order.total | currency:'EUR' }}</span>
        </div>
        <div class="info-row status-row">
            <span class="status-badge" [ngClass]="getBadgeClass(order.state)">
                {{ order.state }}
            </span>
        </div>
      </div>
      
      <div class="card-footer">
          <span class="view-details">Ver detalles →</span>
      </div>
    </div>
  </div>
</div>

<app-order-details-modal
  [isOpen]="showDetails"
  [order]="selectedOrder"
  (close)="closeDetails()"
  (orderUpdated)="refreshOrders()"
>
</app-order-details-modal>
